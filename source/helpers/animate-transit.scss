// ANIMATE TRANSIT
// -----------------------------------------------------------------------------

@use "sass:list";
@use "sass:math";
@use "../settings" as *;

@mixin animate-transit($item, $effects: ("fade", "slide"), $phases: ("in", "out"), $translate-axis: "Y", $translate-length: -1rem) {
  $valid-effects: ("fade", "slide");
  $valid-phases: ("in", "out");
  $valid-translate-axes: ("X", "Y");
  $valid-translate-units: ("px", "em", "rem", "vw", "vh", "%");

  @each $effect in $effects {
    @if not (list.index($valid-effects, $effect)) {
      @error "Invalid transit animation effect name. Check spelling or review helper definition.";
    }
  }
  @each $phase in $phases {
    @if not (list.index($valid-phases, $phase)) {
      @error "Invalid transit animation phase name. Check spelling or review helper definition.";
    }
  }
  @if not (list.index($valid-translate-axes, $translate-axis)) {
    @error "Invalid translate axis name. Check spelling or review helper definition.";
  }
  @if not (list.index($valid-translate-units, math.unit($translate-length))) {
    @error "Invalid translate length unit. Check spelling or review helper definition.";
  }

  $opacity-change: if(list.index($effects, "fade"), true, false);
  $opacity-start: 0;
  $opacity-end: 1;
  $transform-change: if(list.index($effects, "slide"), true, false);
  $transform-start: translate#{$translate-axis}(#{$translate-length});
  $transform-end: translate#{$translate-axis}(0);

  @each $phase in $phases {
    @if ($phase == "out") {
      $opacity-start: 1;
      $opacity-end: 0;
      $transform-start: translate#{$translate-axis}(0);
      $transform-end: translate#{$translate-axis}(#{$translate-length});
    }

    @keyframes #{$item}-transit-#{$phase} {
      0% {
        @if $opacity-change {
          opacity: $opacity-start;
        }
        @if $transform-change {
          transform: $transform-start;
        }
      }
      100% {
        @if $opacity-change {
          opacity: $opacity-end;
        }
        @if $transform-change {
          transform: $transform-end;
        }
      }
    }
  }
}
